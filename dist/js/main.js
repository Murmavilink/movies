(()=>{"use strict";(()=>{const e="https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_100_POPULAR_FILMS&page=1",a=document.querySelector("form"),n=document.querySelector(".header__search"),s=document.querySelector(".movies");document.querySelector(".modal"),a.addEventListener("submit",(a=>{a.preventDefault(),n.value?o("https://kinopoiskapiunofficial.tech/api/v2.1/films/search-by-keyword?keyword="+n.value).then((e=>{i(e)})):o(e).then((e=>{i(e)})),n.value=""}));const o=async e=>{const a=await fetch(e,{method:"GET",headers:{"X-API-KEY":"aa9207e0-e928-4988-878f-a6ef9e404c47","Content-Type":"application/json"}});return await a.json()},i=e=>{s.innerHTML="",e.films.forEach((e=>{const a=document.createElement("div");a.classList.add("movie"),a.insertAdjacentHTML("beforeend",`\n            <div class="movie__cover-inner">\n                <img src="${e.posterUrlPreview}" class="movie__cover"\n                    alt="${e.nameRu}">\n                <div class="movie__cover--darkened"></div>\n                </div>\n                <div class="movie__info">\n                <div class="movie__title">${e.nameRu}</div>\n                <div class="movie__category">\n                ${e.genres.map((e=>e.genre)).join(", ")}\n                </div>\n                ${+e.rating?`<div class="movie__average movie__average--${l(e.rating)}">${e.rating}</div>`:""}\n            </div>`),s.append(a)}))},l=e=>e>=7?"green":e>5?"orange":"red";o(e).then((e=>{i(e)}))})(),(async()=>{const e={};let a,n;await getMovies(API_URL_MOVIE_DETAILS+id).then((e=>{a=e})),await getMovies(API_URL_MOVIE_DETAILS+id+"/videos").then((e=>{n=e})),n.items.forEach(((a,n)=>{a&&n<1&&(e.name=a.name,e.url=a.url)})),document.body.classList.add("stop-scrolling"),modalEl.classList.add("modal--show"),modalEl.innerHTML="",modalEl.insertAdjacentHTML("beforeend",`\n    <div class="modal__card">\n        <img class="modal__movie-backdrop" src="${a.posterUrlPreview}" alt="">\n        <h2>\n            <span class="modal__movie-title">${a.nameRu}</span>\n            <span class="modal__movie-release-year">${a.year}</span>\n        </h2>\n        <ul class="modal__movie-info">\n            <div class="loader"></div>\n            <li class="modal__movie-genre">Жанр - ${a.genres.map((e=>e.genre)).join(", ")}</li>\n            ${a.filmLength?`<li class="modal__movie-runtime">Время - ${a.filmLength} минут</li>`:""}\n            <li >Сайт: <a class="modal__movie-site" href="${a.webUrl}">${a.webUrl}</a></li>\n            <li class="modal__movie-overview">Описание - ${a.description}</li>\n            ${Object.keys(e).length?`<li>${e.name} <a class="modal__movie-site" target="_blank" href="${e.url}">${e.url}</a></li>`:""}\n        </ul>\n        <button type="button" class="modal__button-close">Закрыть</button>\n    </div>`),modalEl.addEventListener("click",(e=>{!e.target.classList.contains("modal__button-close")&&e.target.closest(".modal__card")||(modalEl.classList.remove("modal--show"),document.body.classList.remove("stop-scrolling"))})),window.addEventListener("keydown",(e=>{"Escape"===e.key&&modalEl.classList.remove("modal--show")}))})()})();